{% extends "layout.twig" %}

{% block body %}
{# Hero Section with Gradient #}
<div class="hero-section">
    <div class="hero-grid">
        {# Left Side - Content #}
        <div class="hero-content">
            <div class="logo mb-4" style="font-size: 20px;">1 Trillion Smiles</div>

            <h1>Spread Smiles,<br>Not status</h1>

            <p>Smiles are heartfelt messages you send that create happiness and make people's day.</p>

            <div class="hero-stats">
                <div class="hero-stat-item">
                    <div class="hero-stat-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="10"/><path d="M2 12h20M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/>
                        </svg>
                    </div>
                    <span><strong>{{ global_smiles|number_format }}</strong> of 1T smiles spread worldwide</span>
                </div>
                <div class="hero-stat-item">
                    <div class="hero-stat-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/>
                        </svg>
                    </div>
                    <span><strong>{{ total_companies }}</strong> companies spreading smiles</span>
                </div>
                <div class="hero-stat-item">
                    <div class="hero-stat-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="23 6 13.5 15.5 8.5 10.5 1 18"/><polyline points="17 6 23 6 23 12"/>
                        </svg>
                    </div>
                    <span><strong>847</strong> smiles spread at Google</span>
                </div>
            </div>
        </div>

        {# Right Side - Signup Card #}
        <div class="signup-card">
            <h3>Get Started</h3>
            <form id="signup-form">
                <div class="form-group">
                    <label class="form-label">Your name</label>
                    <input type="text" name="name" class="form-input" placeholder="Alex" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Your email</label>
                    <input type="email" name="email" class="form-input" placeholder="alex@example.com" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Your avatar</label>
                    <div class="avatar-grid">
                        {% set avatars = ['ğŸŒŸ', 'ğŸŒˆ', 'â˜€ï¸', 'ğŸˆ', 'ğŸŒ¸', 'ğŸ¨', 'ğŸª', 'ğŸ­', 'ğŸ¦‹', 'ğŸŒº'] %}
                        {% for avatar in avatars %}
                            <button type="button" class="avatar-option" data-avatar="{{ avatar }}">{{ avatar }}</button>
                        {% endfor %}
                    </div>
                    <input type="hidden" name="avatar" id="avatar-input" required>
                </div>
                <button type="submit" class="btn btn-primary" style="width: 100%;">
                    Start Spreading Smiles
                </button>
            </form>
        </div>
    </div>
</div>

{# Problem/Solution Section #}
<div class="content-section">
    <div class="container">
        <h2 class="section-title">The Internet is making us miserable, so let's fix it.</h2>

        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 32px; margin-bottom: 80px;">
            <div class="stat-card">
                <div style="font-size: 48px; margin-bottom: 16px;">ğŸ˜”</div>
                <p style="color: var(--text-gray); font-size: 15px; line-height: 1.6;">Between endless scrolling, comparing our lives to highlight reels, or chasing likes or comments that don't actually make us happy, depression rates among young people have doubled over the past decade.</p>
            </div>
            <div class="stat-card">
                <div style="font-size: 48px; margin-bottom: 16px;">ğŸ™‚</div>
                <p style="color: var(--text-gray); font-size: 15px; line-height: 1.6;">So instead of vanity metrics, shallow self-promotion, or algorithms that make you feel inadequate, focus on what really makes us happy - kindness, gratitude, and the simple joy of making someone's day better.</p>
            </div>
        </div>

        <h2 class="section-title mb-3">Mission: Create 1 trillion smiles, one at a time.</h2>
        <p class="section-subtitle">Send smiles to the people who make your day, workplace, or entire life better, and join the movement to make the internet a little brighter.</p>

        <div class="stats-grid">
            {# Total Smiles Card #}
            <div class="stat-card">
                <div class="stat-card-header">
                    <div class="stat-card-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                            <circle cx="12" cy="12" r="10"/><path d="M2 12h20M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/>
                        </svg>
                    </div>
                    <div>
                        <div class="stat-card-title">Total Smiles</div>
                        <div class="stat-card-subtitle">created globally</div>
                    </div>
                </div>
                <div class="stat-card-number">{{ global_smiles|number_format }}</div>
                <div class="stat-card-label">{{ global_progress }}% of 1 trillion</div>
                <div class="stat-card-progress">
                    <div class="stat-card-progress-bar" style="width: {{ global_progress }}%;"></div>
                </div>
            </div>

            {# Companies Card #}
            <div class="stat-card">
                <div class="stat-card-header">
                    <div class="stat-card-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                            <rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/>
                        </svg>
                    </div>
                    <div>
                        <div class="stat-card-title">{{ total_companies }} companies</div>
                        <div class="stat-card-subtitle">spreading smiles</div>
                    </div>
                </div>

                {% for company in top_companies %}
                    <div class="leaderboard-item">
                        <div class="leaderboard-rank">#{{ loop.index }}</div>
                        <div class="leaderboard-avatar">ğŸ¢</div>
                        <div class="leaderboard-info">
                            <div class="leaderboard-name">{{ company.company }}</div>
                            <div class="leaderboard-count">{{ company.smile_count }} smiles created</div>
                        </div>
                    </div>
                {% endfor %}
            </div>

            {# Top Senders Card #}
            <div class="stat-card">
                <div class="stat-card-header">
                    <div class="stat-card-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                            <polyline points="23 6 13.5 15.5 8.5 10.5 1 18"/><polyline points="17 6 23 6 23 12"/>
                        </svg>
                    </div>
                    <div>
                        <div class="stat-card-title">847 Google smiles</div>
                        <div class="stat-card-subtitle">from Google employees</div>
                    </div>
                </div>

                <div class="leaderboard-item">
                    <div class="leaderboard-rank">#1</div>
                    <div class="leaderboard-avatar">ğŸ‘¤</div>
                    <div class="leaderboard-info">
                        <div class="leaderboard-name">Sarah Chen</div>
                        <div class="leaderboard-count">42 smiles created</div>
                    </div>
                </div>
                <div class="leaderboard-item">
                    <div class="leaderboard-rank">#2</div>
                    <div class="leaderboard-avatar">ğŸ‘¤</div>
                    <div class="leaderboard-info">
                        <div class="leaderboard-name">Mike Rodriguez</div>
                        <div class="leaderboard-count">38 smiles created</div>
                    </div>
                </div>
                <div class="leaderboard-item">
                    <div class="leaderboard-rank">#3</div>
                    <div class="leaderboard-avatar">ğŸ‘¤</div>
                    <div class="leaderboard-info">
                        <div class="leaderboard-name">Priya Patel</div>
                        <div class="leaderboard-count">34 smiles created</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
// Avatar picker
document.querySelectorAll('.avatar-option').forEach(btn => {
    btn.addEventListener('click', function(e) {
        e.preventDefault();
        document.querySelectorAll('.avatar-option').forEach(b => b.classList.remove('selected'));
        this.classList.add('selected');
        document.getElementById('avatar-input').value = this.dataset.avatar;
    });
});

// Signup form
document.getElementById('signup-form').addEventListener('submit', async function(e) {
    e.preventDefault();

    const formData = new FormData(this);
    const data = {
        name: formData.get('name'),
        email: formData.get('email'),
        avatar: formData.get('avatar')
    };

    if (!data.avatar) {
        alert('Please pick your vibe');
        return;
    }

    try {
        const response = await fetch('/api/signup', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(data)
        });

        const result = await response.json();

        if (result.success) {
            window.location.href = `/dashboard/${result.dashboard_url}?first_visit=1`;
        } else {
            alert(result.error || 'Signup failed. Please try again.');
        }
    } catch (error) {
        console.error('Signup error:', error);
        alert('An error occurred. Please try again.');
    }
});
</script>
{% endblock %}
